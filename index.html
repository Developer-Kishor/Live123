<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live TV Channels</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Kishor Stream - TV</h1>
    </header>

    <div class="search-container">
        <input type="text" id="search-bar" placeholder="Search Channels..." onkeyup="filterChannels()">
    </div>

    <div class="container" id="channel-container">
        <!-- Channels will be loaded here -->
    </div>

    <script>
        // Function to redirect to the player page
        function redirectToPlayer(url, name) {
            const playerUrl = 'player.html?videoUrl=' + encodeURIComponent(url) + '&alias=' + encodeURIComponent(name);
            window.location.href = playerUrl;
        }

        // Function to parse and display channels
        function loadChannels() {
            // Fetch your custom file or data source that contains the channel info
            fetch('channels.txt') // Replace with your file path
                .then(response => response.text())
                .then(data => {
                    const lines = data.split('\n');
                    const channels = [];
                    let currentChannel = {};

                    lines.forEach(line => {
                        if (line.startsWith('#EXTINF')) {
                            // Extract channel details
                            const nameMatch = line.match(/,(.+)/);
                            const logoMatch = line.match(/tvg-logo="(.+?)"/);
                            if (nameMatch) {
                                currentChannel.name = nameMatch[1];
                                currentChannel.logo = logoMatch ? logoMatch[1] : '';
                            }
                        } else if (line.trim().startsWith('http')) {
                            // URL of the stream (assuming it's a direct link or playlist URL)
                            currentChannel.url = line.trim();
                            channels.push(currentChannel);
                            currentChannel = {}; // Reset for next channel
                        }
                    });

                    displayChannels(channels);
                })
                .catch(error => console.error('Error loading channels:', error));
        }

        // Function to display channels on the page
        function displayChannels(channels) {
            const channelContainer = document.getElementById('channel-container');
            channelContainer.innerHTML = ''; // Clear previous entries

            channels.forEach(channel => {
                const channelDiv = document.createElement('div');
                channelDiv.classList.add('channel');
                channelDiv.onclick = () => redirectToPlayer(channel.url, channel.name);

                channelDiv.innerHTML = `
                    <img src="${channel.logo}" alt="${channel.name}">
                    <p>${channel.name}</p>
                `;

                channelContainer.appendChild(channelDiv);
            });
        }

        // Function to filter channels based on search input
        function filterChannels() {
            const searchValue = document.getElementById('search-bar').value.toLowerCase();
            const channels = document.querySelectorAll('.channel');

            channels.forEach(channel => {
                const channelName = channel.querySelector('p').textContent.toLowerCase();
                if (channelName.includes(searchValue)) {
                    channel.style.display = '';
                } else {
                    channel.style.display = 'none';
                }
            });
        }

        // Load channels on page load
        window.onload = loadChannels;
    </script>
</body>
</html>